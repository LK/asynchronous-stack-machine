import "lab_syn.act";
import "opcode_conditions.act";
import "functions.act";

defproc toplevel (a1of1 go; dualrail var_ctrl, var_test_op; dualrail var_test_data[8])
{
 /* --- declaring all variables and channels --- */
 aN1of2<8> chan_stack9_comm_chan;
 syn_var_init_false var_ctrl2;
 aN1of2<8> chan_stack10_comm_chan;
 syn_var_init_false var_stack9_data[8];
 syn_var_init_false var_stack9_is_full;
 syn_var_init_false var_stack10_is_full;
 syn_var_init_false var_stack9_op;
 a1of2 chan_stack10_op_chan;
 syn_var_init_false var_stack10_data[8];
 a1of2 chan_stack9_op_chan;
 syn_var_init_false var_stack10_op;
 /* --- end of declarations --- */

/* comma */
 a1of1 c_0;
/* semicolon */
 a1of1 c_1;
/* assign */
 syn_var_init_false const_0;
 syn_expr_var e_1(,const_0.v);
 a1of1 c_2;
 syn_fullseq s_1;
 c_2.r = s_1.go.r;
 syn_recv rtv_1;
 syn_expr_var e_2;
 syn_var_init_false tv_1(rtv_1.v);
 e_2.v = tv_1.v;
 s_1.r.r = e_1.go_r;
 s_1.r = rtv_1.go;
 e_1.out.t = rtv_1.in.t;
 e_1.out.f = rtv_1.in.f;
 s_1.go.a = e_2.go_r;
 syn_recv s_0(c_2);
 s_0.in.t = e_2.out.t;
 s_0.in.f = e_2.out.f;
 s_0.v = var_stack9_is_full.v;

 syn_seq s_2(c_1);
 s_2.s1 = c_2;

 /*--- emit individual gc (#0) [loop] ---*/
 r1of2 gc_0;
/* semicolon */
 a1of1 c_3;
/* recv */
 a1of1 c_4;
 syn_fullseq fs_3(c_4,);
 syn_recv s_3(fs_3.r);
 s_3.in = chan_stack9_op_chan;
 s_3.v = var_stack9_op.v;

 syn_seq s_4(c_3);
 s_4.s1 = c_4;

 /*--- emit individual gc (#1) [selection] ---*/
 r1of2 gc_1;
 syn_expr_var e_3(,var_stack9_is_full.v);
 syn_expr_not e_4(e_3.out);
 syn_expr_var e_5(,var_stack9_op.v);
 e_5.go_r = e_3.go_r;
 syn_expr_and e_6(e_4.out, e_5.out);
 syn_fullseq s_5;
 gc_1.r = s_5.go.r;
 syn_recv rtv_5;
 syn_expr_var e_7;
 syn_var_init_false tv_5(rtv_5.v);
 e_7.v = tv_5.v;
 s_5.r.r = e_3.go_r;
 s_5.r = rtv_5.go;
 e_6.out.t = rtv_5.in.t;
 e_6.out.f = rtv_5.in.f;
 s_5.go.a = e_7.go_r;
/* semicolon */
 a1of1 c_5;
/* recv */
 a1of1 c_6;
 syn_fullseq fs_6(c_6,);
 syn_recv s_6[8];
 (i:8: s_6[i].go.r = fs_6.r.r;)
 syn_ctree<8> ct_6;
 (i:8: ct_6.in[i]=s_6[i].go.a;)
 ct_6.out=fs_6.r.a; fs_6.r.a=chan_stack9_comm_chan.a;
 (i:8: s_6[i].in.t = chan_stack9_comm_chan.d[i].t;
          s_6[i].in.f = chan_stack9_comm_chan.d[i].f;
          s_6[i].v = var_stack9_data[i].v; )

 syn_seq s_7(c_5);
 s_7.s1 = c_6;
/* assign */
 syn_var_init_true const_1;
 syn_expr_var e_8(,const_1.v);
 a1of1 c_7;
 syn_fullseq s_9;
 c_7.r = s_9.go.r;
 syn_recv rtv_9;
 syn_expr_var e_9;
 syn_var_init_false tv_9(rtv_9.v);
 e_9.v = tv_9.v;
 s_9.r.r = e_8.go_r;
 s_9.r = rtv_9.go;
 e_8.out.t = rtv_9.in.t;
 e_8.out.f = rtv_9.in.f;
 s_9.go.a = e_9.go_r;
 syn_recv s_8(c_7);
 s_8.in.t = e_9.out.t;
 s_8.in.f = e_9.out.f;
 s_8.v = var_stack9_is_full.v;

 s_7.s2 = c_7;

 e_7.out.t = c_5.r;
 gc_1.t = c_5.a;
 gc_1.f = e_7.out.f;
 r1of2 gc_2;
/* skip */   a1of1 c_8;
 syn_skip s_10(c_8);
 gc_2.r = c_8.r;
 gc_2.t = c_8.a;
 gc_2.f = GND;
 a1of1 c_9;
 /* gc cascade, start=1, end=2 */
 gc_1.f = gc_2.r;
 gc_1.r = c_9.r;
 syn_or2 or_11(gc_1.t,gc_2.t);
 or_11.out = c_9.a;
 /* ----- end of gc (#1) ----- */

 s_4.s2 = c_9;

 gc_0.r = c_3.r;
 gc_0.t = c_3.a;
 gc_0.f = GND;
 a1of1 c_10;
 /* gc cascade, start=0, end=0 */
 syn_notand na_12;
 na_12.x = c_10.r;
 na_12.out = gc_0.r;
 gc_0.t = na_12.y;
 gc_0.f = c_10.a;
 /* ----- end of gc (#0) ----- */

 s_2.s2 = c_10;

 syn_par s_13(c_0);
 s_13.s1 = c_1;

 /*--- emit individual gc (#2) [loop] ---*/
 r1of2 gc_3;
 syn_expr_var e_10(,var_ctrl);
 syn_fullseq s_14;
 gc_3.r = s_14.go.r;
 syn_recv rtv_14;
 syn_expr_var e_11;
 syn_var_init_false tv_14(rtv_14.v);
 e_11.v = tv_14.v;
 s_14.r.r = e_10.go_r;
 s_14.r = rtv_14.go;
 e_10.out.t = rtv_14.in.t;
 e_10.out.f = rtv_14.in.f;
 s_14.go.a = e_11.go_r;
/* semicolon */
 a1of1 c_11;
/* send */
 syn_expr_var e_12(,var_test_op);
 a1of1 c_12;
 a1of1 recv_r_15;
 syn_fullseq fs_15(c_12, recv_r_15);
 syn_fullseq s_16;
 recv_r_15.r = s_16.go.r;
 syn_recv rtv_16;
 syn_expr_var e_13;
 syn_var_init_false tv_16(rtv_16.v);
 e_13.v = tv_16.v;
 s_16.r.r = e_12.go_r;
 s_16.r = rtv_16.go;
 e_12.out.t = rtv_16.in.t;
 e_12.out.f = rtv_16.in.f;
 s_16.go.a = e_13.go_r;
 recv_r_15.a = chan_stack9_op_chan.a;
 chan_stack9_op_chan.t = e_13.out.t;
 chan_stack9_op_chan.f = e_13.out.f;

 syn_seq s_17(c_11);
 s_17.s1 = c_12;
 a1of1 c_13;
 s_17.s2 = c_13;
/* assign */
 syn_expr_var e_14(,const_0.v);
 a1of1 c_14;
 syn_fullseq s_19;
 c_14.r = s_19.go.r;
 syn_recv rtv_19;
 syn_expr_var e_15;
 syn_var_init_false tv_19(rtv_19.v);
 e_15.v = tv_19.v;
 s_19.r.r = e_14.go_r;
 s_19.r = rtv_19.go;
 e_14.out.t = rtv_19.in.t;
 e_14.out.f = rtv_19.in.f;
 s_19.go.a = e_15.go_r;
 syn_recv s_18(c_14);
 s_18.in.t = e_15.out.t;
 s_18.in.f = e_15.out.f;
 s_18.v = var_ctrl;

 syn_seq s_20(c_13);
 s_20.s1 = c_14;
 a1of1 c_15;
 s_20.s2 = c_15;
/* assign */
 syn_expr_var e_16(,const_1.v);
 a1of1 c_16;
 syn_fullseq s_22;
 c_16.r = s_22.go.r;
 syn_recv rtv_22;
 syn_expr_var e_17;
 syn_var_init_false tv_22(rtv_22.v);
 e_17.v = tv_22.v;
 s_22.r.r = e_16.go_r;
 s_22.r = rtv_22.go;
 e_16.out.t = rtv_22.in.t;
 e_16.out.f = rtv_22.in.f;
 s_22.go.a = e_17.go_r;
 syn_recv s_21(c_16);
 s_21.in.t = e_17.out.t;
 s_21.in.f = e_17.out.f;
 s_21.v = var_ctrl2.v;

 syn_seq s_23(c_15);
 s_23.s1 = c_16;
 a1of1 c_17;
 s_23.s2 = c_17;
/* send */
 syn_expr_vararray<8> e_18;
 (i:8: e_18.v[i] = var_test_data[i];)
 a1of1 c_18;
 a1of1 recv_r_24;
 syn_fullseq fs_24(c_18, recv_r_24);
 syn_fullseq s_25;
 recv_r_24.r = s_25.go.r;
 syn_recv rtv_25[8];
 syn_expr_vararray<8> e_19;
 syn_var_init_false tv_25[8];
 (i:8: e_19.v[i] = tv_25[i].v; e_19.v[i]=rtv_25[i].v;)
 s_25.r.r = e_18.go_r;
 (i:8: s_25.r.r = rtv_25[i].go.r;)
 syn_ctree<8> ct_25;
 (i:8: ct_25.in[i]=rtv_25[i].go.a;)
 s_25.r.a = ct_25.out;
 (i:8: e_18.out[i].t = rtv_25[i].in.t; e_18.out[i].f = rtv_25[i].in.f;)
 s_25.go.a = e_19.go_r;
 recv_r_24.a = chan_stack9_comm_chan.a;
 (i:8: chan_stack9_comm_chan.d[i] = e_19.out[i];)

 syn_seq s_26(c_17);
 s_26.s1 = c_18;
/* assign */
 syn_expr_var e_20(,const_0.v);
 a1of1 c_19;
 syn_fullseq s_28;
 c_19.r = s_28.go.r;
 syn_recv rtv_28;
 syn_expr_var e_21;
 syn_var_init_false tv_28(rtv_28.v);
 e_21.v = tv_28.v;
 s_28.r.r = e_20.go_r;
 s_28.r = rtv_28.go;
 e_20.out.t = rtv_28.in.t;
 e_20.out.f = rtv_28.in.f;
 s_28.go.a = e_21.go_r;
 syn_recv s_27(c_19);
 s_27.in.t = e_21.out.t;
 s_27.in.f = e_21.out.f;
 s_27.v = var_ctrl2.v;

 s_26.s2 = c_19;

 e_11.out.t = c_11.r;
 gc_3.t = c_11.a;
 gc_3.f = e_11.out.f;
 a1of1 c_20;
 /* gc cascade, start=3, end=3 */
 syn_notand na_29;
 na_29.x = c_20.r;
 na_29.out = gc_3.r;
 gc_3.t = na_29.y;
 gc_3.f = c_20.a;
 /* ----- end of gc (#2) ----- */

 s_13.s2 = c_20;

 go = c_0;
}
